<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Temp</title>
    <script type="text/javascript" src="app.js"></script>
  </head>
  <body onload="init()">
        <textarea id="message-box" rows="2" cols="40" placeholder="Enter message here..."></textarea>
        <button id="submit" onclick="post()">Send</button>
        <h1>Messages:</h1>
        <div id="sent-messages">
          <div id="message-container" style="color = green"></div>
        </div>
    <script src="https://www.gstatic.com/firebasejs/3.6.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-messaging.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAuC_xqXKk99bTeaCluuoJhqNfJFQNlv1E",
        authDomain: "epproject-a2ea7.firebaseapp.com",
        databaseURL: "https://epproject-a2ea7.firebaseio.com",
        storageBucket: "epproject-a2ea7.appspot.com",
        messagingSenderId: "638364827583"
      };
      firebase.initializeApp(config);
    </script>
  </body>
  <script>
    function init() {
      var val = firebase.database().ref('users/archie/messages/chat1');
      val.on('value', function(snapshot) {
        var newPost = snapshot.val();
        var para = document.createElement("P");
        var t = document.createTextNode(newPost.message);
        para.appendChild(t);
        document.getElementById('message-container').appendChild(para);
      });

    }
    function post() {
      var postText = document.getElementById("message-box").value;
      this.database = firebase.database();
      this.messagesRef = this.database.ref('users/archie/messages/chat1/');
      // Get a key for a new Post.
      var newPostKey = firebase.database().ref().child('chat1').push().key;

      this.messagesRef.update( {
        message: postText
      });
    }
  </script>
</html>
